{% extends 'base.html' %}

{% block title %}ユーザー一覧{% endblock %}

{% block contents %}
<div class="container mt-4">
    <h2 class="mb-4">ユーザー一覧</h2>

    <form method="get" class="mb-3 d-flex">
        <input type="text" name="q" value="{{ q }}" placeholder="名前やメールで検索" class="form-control me-2">
        <button type="submit" class="btn btn-primary">検索</button>
    </form>

    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>ログインID</th>
                <th>氏名</th>
                <th>メール</th>
                <th>部署</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for obj in object_list %}
                <tr>
                    <td>{{ obj.pk }}</td>
                    <td>{{ obj.username }}</td>
                    <td>{{ obj.full_name }}</td>
                    <td>{{ obj.email }}</td>
                    <td>{{ obj.department }}</td>
                    <td>
                        {% if request.user.is_superuser %}
                            <a href="{% url 'accounts:profile_delete' obj.pk %}" class="btn btn-danger btn-sm">削除</a>
                        {% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="6">ユーザーが見つかりませんでした。</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <nav>
        <ul class="pagination">
            {% if object_list.has_previous %}
                <li class="page-item">
                    <a href="?q={{ q }}&page={{ object_list.previous_page_number }}" class="page-link">前へ</a>
                </li>
            {% endif %}
            
            {% for num in object_list.paginator.page_range %}
                {% if object_list.number == num %}
                    <li class="page-item active"><span class="page-link">{{ num }}</span></li>
                {% else %}
                    <li class="page-item"><a href="?q={{ q }}&page={{ num }}" class="page-link">{{ num }}</a></li>
                {% endif %}
            {% endfor %}

            {% if object_list.has_next %}
                <li class="page-item">
                    <a href="?q={{ q }}&page={{ object_list.next_page_number }}" class="page-link"次へ></a>
                </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endblock %}